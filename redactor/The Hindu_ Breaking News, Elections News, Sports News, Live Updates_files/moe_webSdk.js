var isMobileMoe=!1;(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(isMobileMoe=!0),!function(a){"use strict";function b(){}function c(a,b){if(e)return b.indexOf(a);for(var c=b.length;c--;)if(b[c]===a)return c;return-1}var d=b.prototype,e=!!Array.prototype.indexOf;d._getEvents=function(){return this._events||(this._events={})},d.getListeners=function(a){var b,c,d=this._getEvents();if("object"==typeof a){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},d.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},d.addListener=function(a,b){var d,e=this.getListenersAsObject(a);for(d in e)e.hasOwnProperty(d)&&-1===c(b,e[d])&&e[d].push(b);return this},d.on=d.addListener,d.defineEvent=function(a){return this.getListeners(a),this},d.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},d.removeListener=function(a,b){var d,e,f=this.getListenersAsObject(a);for(e in f)f.hasOwnProperty(e)&&(d=c(b,f[e]),-1!==d&&f[e].splice(d,1));return this},d.off=d.removeListener,d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},d.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},d.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if("object"===c)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},d.emitEvent=function(a,b){var c,d,e,f=this.getListenersAsObject(a);for(d in f)if(f.hasOwnProperty(d))for(c=f[d].length;c--;)e=b?f[d][c].apply(null,b):f[d][c](),e===!0&&this.removeListener(a,f[d][c]);return this},d.trigger=d.emitEvent,d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},"function"==typeof define&&define.amd?define(function(){return b}):a.EventEmitter=b,a.EventEmitter||(a.EventEmitter=b)}(this),function(a){function b(a){var b=h();return"object"==typeof a&&a.type?l[a.type]?l[a.type].push(b):(l[a.type]=[],l[a.type].push(b)):l[a]?l[a].push(b):(l[a]=[],l[a].push(b)),i.p.then(function(){document.getElementById(f)?document.getElementById(f).contentWindow.postMessage(a,g):console.log("IFRAME IS MISSING - Please include the iframe when doing an HTTP integration. For docs, click here http://docs.moengage.com/docs/http-integration .")}),b.p}function c(a,b){m[a]=b}function d(a){a.origin||a.originalEvent.origin;if(a.data&&a.data.type){if(l[a.data.type]){for(var b=0;b<l[a.data.type].length;)l[a.data.type][b].res(a.data),b++;delete l[a.data.type]}m[a.data.type]&&m[a.data.type](a)}}function e(c,d){f=c,g=d,a.webio.sendMessage=b}if("undefined"==typeof Promise)console.log("Promises not supported!");else{var f,g,h=function(){var a,b,c=new Promise(function(c,d){a=c,b=d});return{p:c,res:a,rej:b}},i=h(),j=function(a){function b(b,e){for(var g=0;g<f.length;){if(a[b]==f[g]){e?(f.splice(g,1),0==f.length&&c()):d();break}g++}}var c,d,e=new Promise(function(a,b){c=a,d=b});if("object"!=typeof a&&!a.length)return void console.log("all - Expects array with atleast one element as input!");for(var f=[],g=0;g<a.length;)f.push(a[g]),function(c){a[c].then(function(){b(c,!0)},function(){b(c,!1)})}(g),g++;return e},k=function(a){var b,c,d=new Promise(function(a,d){b=a,c=d});return setTimeout(function(){b()},a),d},l={},m={},n=function(a,b){a&&b?e(a,b):console.log("webio USAGE-  webio.sendMessageInit(<frame-id>,<iframe-url>)")};a.webio={factory:h,sendMessageInit:n,onMessage:c,all:j,timeout:k,onload:i},a.addEventListener("message",d,!1)}}(window);var moeLoadingComplete=!1,moeSubscribeUserSwap,moeUnSubscribeUserSwap,moeCheckPushSubscriptionStatus,moeLoadBanner,moeRemoveBanner,moeOpenPopup,moeIsOpenedOnce,moeCloseBanner,httpsFlag,webSdkIntegration=!1,permissionStateVal,moeEvents=new EventEmitter,moeBannerText="banner",moe=function(a){function b(){return J||(J=webio.factory()),I||(I=new Promise(function(a,b){"undefined"!=typeof Storage?"device_add"in A&&1==A.device_add?(x&&console.log("device already added, not adding again"),y=1,a()):da().then(function(b){sa(w+"/v2/device/add",b,post_data={},function(b,c){b=""==b?{}:JSON.parse(b),200==c?(x&&console.log("Device Added!"),y=1,A.device_add=!0,_(A,!0).then(a)):(x&&console.log("Device not added -- Server Error!"),a())})}):(x&&console.log("Sorry, your browser does not support Web Storage..."),b())}).then(function(){J.res()})),I}function c(){S.then(function(){ea().then(function(a){a.webData.ws&&1==a.webData.ws&&ja()})}).catch(function(a){console.log("WS-CONNECT --",a)})}function e(a){0!==a.errorCode&&(x&&console.log("onConnectionLost:"+a.errorMessage),g())}function f(a){g()}function g(){x&&console.log("disconnected, trying after "+t.backOffTime),t.backOffTime<=32&&(t.backOffTime=2*t.backOffTime,setTimeout(function(){connectionOptions={userName:v.userName,password:v.password},connectionOptions.onSuccess=ga,connectionOptions.onFailure=f,t.connect(connectionOptions)},1e3*t.backOffTime))}function h(){c(),R.res(),"undefined"!=typeof Storage?ea().then(function(a){return new Promise(function(a,b){Q?(x&&console.log("Device added - Normal billing!"),fa().then(a),V.p.then(function(a){"granted"==a||1==A.device_add&&"granted"==A.user_attr["Web Push Preference"]&&A.user_attr["Web Push Preference"]!=a&&fa().then(function(){xa("Web Push Preference",a),wa("MOE_WEB_UNSUBSCRIBED",{Source:"Website"}),moeEvents.emitEvent("permission",[a])})})):V.p.then(function(b){"granted"==b?(fa().then(a),x&&console.log("Device added - Push/email Subscribed billing!")):1==A.device_add&&"granted"==A.user_attr["Web Push Preference"]&&A.user_attr["Web Push Preference"]!=b&&fa().then(function(){a(),webio.all([xa("Web Push Preference",b),wa("MOE_WEB_UNSUBSCRIBED",{Source:"Website"})]).then(function(){moeEvents.emitEvent("permission",[b]),ca()||(A.device_add=!1,_(A,!0),I=null)})}),ca()?fa().then(a):ca()||"granted"==b||1!=A.device_add?a():(A.device_add=!1,_(A,!0),I=null,a())})})}).then(function(){wa("EVENT_ACTION_WEB_SESSION_START",{timestamp:Number(Date.now()),URL:location.href}),wa("MOE_PAGE_VIEWED",{timestamp:Number(Date.now()),URL:location.href}),x&&console.log("User structure: ",A),moeEvents.emitEvent("moeEvents",["loadingComplete"]),moeLoadingComplete=!0,setInterval(function(){$()},retry_time)}):x&&console.log("%cSorry, your browser does not support Web Storage...","color:red; font-size:20px")}function j(a){settingsData=a.webData.banner,moeLoadBanner=function(){"ACCEPT"!=localStorage.getItem("MOE_ACCEPTED")&&"DENY"!=localStorage.getItem("MOE_ACCEPTED")&&s(a)&&moeLoadBannerInternal()},moeLoadOldBanner=function(){var a="top:50%;display:inline-table;transform: translateY(-50%);position:relative;cursor:pointer;",b="color:"+settingsData.opt_in_text_color,c="text-decoration:"+settingsData.opt_in_text_style,d="font-size:"+settingsData.opt_in_text_font_size+"px",e=a+b+";"+c+";"+d+";",f='style="'+e;if(1==httpsFlag)var g="moeBannerText",h='<span onclick="moeSubscribeUserSwap('+g+')"'+f+'">';else var g="moeBannerText",h='<span onclick="moeIsOpenedOnce('+g+')"'+f+'">';var i="top:50%;display:inline-table;transform: translateY(-50%);position:relative;margin-left:10px;cursor:pointer;",j="color:"+settingsData.close_text_color,k="text-decoration:"+settingsData.close_text_style,l="font-size:"+settingsData.close_text_font_size+"px",m=i+j+";"+k+";"+l+";",n='style="'+m,o='<span onclick="moeRemoveBanner()"'+n+'">',p=h+settingsData.opt_in_text+"</span>",q=o+settingsData.close_text+"</span>",r='style="top:50%;display:inline-table;transform: translateY(-50%);position:absolute;right:5px;font-size: 12px;padding: 5px;cursor:pointer;'+j+';"',s='<span onclick="moeRemoveBanner()"'+r+'">X</span>',t=p+q+s;document.getElementById("moe-push-div").innerHTML=t;var u=document.querySelector("#moe-push-div");u.style.backgroundColor=settingsData.banner_bg_color,u.style.color=settingsData.banner_txt_color,u.style.height=settingsData.banner_height+"px",u.style.zIndex="9999",u.style.top="0px",u.style.width="100%",u.style.position="relative",u.style.textAlign="center",u.style.fontFamily="'"+settingsData.banner_txt_font+"'"},moeLoadBannerInternal=function(a){var b=document.createElement("div");b.id="moe-push-div",b.className="moe-push-class";var c=document.body.firstChild;c.parentNode.insertBefore(b,c),ea().then(function(b){if(showOldBanner=!0,null!=b.webData.bannerHtml&&("mweb"==Y&&null!=b.webData.bannerHtml.mweb&&(document.getElementById("moe-push-div").innerHTML=b.webData.bannerHtml.mweb,showOldBanner=!1),"web"==Y&&null!=b.webData.bannerHtml.web&&(document.getElementById("moe-push-div").innerHTML=b.webData.bannerHtml.web,showOldBanner=!1)),1==a){if(document.getElementById("moe-push-div").onclick=function(){hideOneClickTransparentOverlay()},"Google Chrome"==u||"Opera Neon"==u){for(var c=document.getElementsByClassName("moe_chrome"),d=c.length-1;d>=0;d--)c[d].style.display="block";0==c.length&&(document.getElementById("moe-push-div").style.display="none")}else if("Mozilla Firefox"==u){for(var c=document.getElementsByClassName("moe_firefox"),d=c.length-1;d>=0;d--)c[d].style.display="block";0==c.length&&(document.getElementById("moe-push-div").style.display="none")}else if("Opera"==u){for(var c=document.getElementsByClassName("moe_opera"),d=c.length-1;d>=0;d--)c[d].style.display="block";0==c.length&&(document.getElementById("moe-push-div").style.display="none")}else if("Apple Safari"==u){for(var c=document.getElementsByClassName("moe_safari"),d=c.length-1;d>=0;d--)c[d].style.display="block";0==c.length&&(document.getElementById("moe-push-div").style.display="none")}return!0}if(showOldBanner)moeLoadOldBanner();else{wa("MOE_WEB_OPTIN_BANNER_LOAD",{});var e=new CustomEvent("MOE_OPT_IN",{detail:"soft_ask_shown"});window.dispatchEvent(e);var f="banner";"https"==b.webData.domain_type&&document.getElementById("optInText")?document.getElementById("optInText").onclick=function(){moeSubscribeUserSwap(f)}:"http"==b.webData.domain_type&&document.getElementById("optInText")?document.getElementById("optInText").onclick=function(){moeIsOpenedOnce(f)}:"http"==b.webData.domain_type&&document.getElementById("optInTextConventional")&&(document.getElementById("optInTextConventional").onclick=function(){o()})}})},hideOneClickTransparentOverlay=function(){if(document.getElementById("moe-push-div")){document.getElementById("moe-push-div").style.display="none",document.getElementById("moe-push-div").style.opacity="0";var a=document.getElementById("moe-push-div");a.parentNode.removeChild(a)}else x&&console.log("moe-push-div MISSING")},moeRemoveBanner=function(){wa("MOE_WEB_OPTIN_CLOSED",{}),localStorage.setItem("SOFT_LOAD",Date.now());var a=document.getElementById("moe-push-div");a.parentNode.removeChild(a)},moeCloseBanner=function(){var a=document.getElementById("moe-push-div");a&&a.parentNode.removeChild(a)}}function k(){webio.sendMessage("get_push_token").then(function(a){a&&a.token&&"null"!=a.token&&!localStorage.getItem("MOE_PUSH_TOKEN")?(localStorage.setItem("MOE_PUSH_TOKEN",a.token),T.res(),x&&console.log("PUSH TOKEN UPDATED!!"),fa().then(function(){moeEvents.emitEvent("permission",["granted"]),xa("Web Push Preference","granted"),xa("Web Subscription URL",window.location.href),wa("MOE_USER_SUBSCRIBED",{MOE_WEB_PUSH_TOKEN:a.token,URL:window.location.href}),wa("MOE_USER_SUBSCRIBED",{MOE_WEB_PUSH_TOKEN:a.token,URL:window.location.href},"calldeviceadd")})):a&&a.token&&localStorage.getItem("MOE_PUSH_TOKEN")!=a.token&&"null"!=a.token&&(localStorage.setItem("MOE_PUSH_TOKEN",a.token),T.res(),x&&console.log("PUSH TOKEN UPDATED!!"),fa().then(function(){moeEvents.emitEvent("permission",["granted"]),xa("Web Push Preference","granted"),wa("MOE_USER_SUBSCRIPTION_CHECK",{MOE_WEB_PUSH_TOKEN:a.token,URL:window.location.href}),wa("MOE_USER_SUBSCRIPTION_CHECK",{MOE_WEB_PUSH_TOKEN:a.token,URL:window.location.href},"calldeviceadd")})),!a||null!=a.token&&"null"!=a.token?T.res():(Na<=2&&(Na+=.5),setTimeout(function(){k()},1e3*Na))})}function l(){V.p.then(function(a){"prompt"==a&&(ea().then(function(a){0==a.webData.banner.banner_flag&&moeLoadBannerInternal(!0)}),moeEvents.on("permission",function(a){hideOneClickTransparentOverlay()}))}),webio.sendMessage("ask_for_notification").then(function(a){moeEvents.emitEvent("permission",["changed"]),a.token&&"ACCEPT"==a.token?(V.p.then(function(a){if("prompt"==a){var b=new CustomEvent("MOE_OPT_IN",{detail:"opt_in_allowed"});window.dispatchEvent(b),wa("MOE_OPT_IN_ALLOWED",{})}}),localStorage.setItem("ask_web_push",!1),k(),"granted"==H||localStorage.getItem("MOE_PUSH_TOKEN")&&"null"!=localStorage.getItem("MOE_PUSH_TOKEN")&&"NA"!=localStorage.getItem("MOE_PUSH_TOKEN")&&Ma||p(),localStorage.setItem("MOE_ACCEPTED","ACCEPT"),moeEvents.emitEvent("permission",["granted"])):a.token&&"PROMPT"==a.token?(V.p.then(function(a){if("prompt"==a){var b=new CustomEvent("MOE_OPT_IN",{detail:"opt_in_dismissed"});window.dispatchEvent(b),wa("MOE_OPT_IN_DISMISSED",{})}}),localStorage.setItem("MOE_ACCEPTED","PROMPT"),localStorage.setItem("MOE_PUSH_TOKEN","NA"),moeEvents.emitEvent("permission",["clicked_close"]),localStorage.setItem("MOE_LAST_PROMPT",Date.now()),W&&(moeEvents.emitEvent("permission",["prompt"]),xa("Web Push Preference","prompt")),ca()||Q||(A.device_add=!1,_(A,!0),I=null)):a.token&&"DENY"==a.token&&(V.p.then(function(a){if("prompt"==a){var b=new CustomEvent("MOE_OPT_IN",{detail:"opt_in_blocked"});window.dispatchEvent(b),wa("MOE_OPT_IN_BLOCKED",{}),wa("Web Push Opt-in Denied",{})}}),localStorage.setItem("MOE_ACCEPTED","DENY"),localStorage.setItem("MOE_PUSH_TOKEN","NA"),localStorage.setItem("ask_web_push",!1),W&&(moeEvents.emitEvent("permission",["denied"]),xa("Web Push Preference","denied")),ca()||Q||(A.device_add=!1,_(A,!0),I=null))})}function m(){return webio.sendMessage("moengage_data_from_frame")}function n(a){da().then(function(b){var c=a,d={type:"moengage_data_to_frame",token:c,collect_data:b};webio.sendMessage(d)})}function o(){wa("MOE_WEB_OPTIN_ACCEPTED",{}),moeCloseBanner(),window.open(ma+"?conventional=1&")}function p(){localStorage.getItem("MOE_HTTP_OVERLAY")||localStorage.setItem("MOE_HTTP_OVERLAY",0),parseInt(localStorage.getItem("MOE_HTTP_OVERLAY"))<2&&(document.getElementById("moe_overlay")?(P||(document.getElementById("moe_overlay").style.display="block",document.getElementById("moe_overlay").style.opacity="1"),localStorage.setItem("MOE_HTTP_OVERLAY",parseInt(localStorage.getItem("MOE_HTTP_OVERLAY"))+1),wa("MOE_HTTP_OVERLAY_SHOWN",{REPEAT:P})):x&&console.log("MOENGAGE_OVERLAY MISSING"))}function q(a,b){function c(a){var b=document.createDocumentFragment(),c=document.createElement("div");for(c.innerHTML=a;c.firstChild;)b.appendChild(c.firstChild);return b}var d;d=b?a.webData.overlayHtmlSubscribed||'<div id="moe_overlay" onclick="moeOpenPopup()" style="display: none; transition: opacity 1s ease-out; opacity: 0;position: fixed;top: 0px;left: 0px;width: 100%;height: 100%;background: rgba(0, 0, 0, 0.6);z-index: 9999999;color: #34495e;font-family: Trebuchet, Arial, sans-serif"><style>.moebtn,.moebtn>*{position:relative}.moebtn,.moebtn span,.moebtn:before{display:block}.moebtn{margin:30px auto;padding:0;overflow:hidden;border-width:0;outline:0;border-radius:2px;box-shadow:0 1px 4px rgba(0,0,0,.6);background-color:#2ecc71;color:#ecf0f1;transition:background-color .3s}.moebtn:focus,.moebtn:hover{background-color:#27ae60}.moe_content,.moebtn:before{position:absolute;top:50%;left:50%}.moebtn span{padding:12px 24px}.moebtn:before{content:"";width:0;padding-top:0;border-radius:100%;background-color:rgba(236,240,241,.3);-webkit-transform:translate(-50%,-50%);-moz-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.moebtn:active:before{width:120%;padding-top:120%;transition:width .5s ease-out,padding-top .5s ease-out}.moebtn.moeorange{background-color:#e67e22}.moebtn.moeorange:focus,.moebtn.moeorange:hover{background-color:#d35400}.moe_content{width:25%;transform:translate(-50%,-50%);background:rgba(255,255,255,.95);border-radius:10px 10px 0px 0px;text-align:center;display:inline-block}@media only screen and (max-width:800px){.moe_content{background:#fff;border-radius:10px 10px 0px 0px;display:inline-block;left:50%;position:absolute;text-align:center;top:50%;transform:translate(-EUNITNO50%,-50%);width:85%}}</style><div id="moe_container" style="text-align: center;display: table-cell;vertical-align: middle;"><div class="moe_content"><center><img src="https://cdn.moengage.com/images/check.gif" height="100px" width="100px"><h2 style="padding:5px;font-weight: 400;font-size:25px;">You are subscribed!</h2><button type="button" class="moebtn moeorange"><span>Close</span></button></center><div style="text-align: right !important;position: absolute !important;    right: 0px !important;border-radius:0px 0px 10px 10px;width:100%;background:rgba(0,0,0,0.7);float:right;"><a href="#" target="_blank" style="text-decoration: none !important;cursor: pointer !important;color:#A5A0A0 !important;font-size: 11px !important;display:inline;" onclick="window.open(\'https://moengage.com/web-push/?utm_source=moengage_branding&utm_medium=webpush\',\'_blank\');event.cancelBubble = true; if (event.stopPropagation) event.stopPropagation();return false;"> Powered by <img src="https://cdn.moengage.com/images/logo-light.png" style="max-width: 100% !important; height: 35px !important;vertical-align: middle !important; padding-right: 3px !important;margin-bottom:auto;display:inline;"></a></div></div></div></div>':a.webData.overlayHtml||'<div id="moe_overlay" onclick="moeOpenPopup()" style="display: none; transition: opacity 1s ease-out; opacity: 0;position: fixed;top: 0px;left: 0px;width: 100%;height: 100%;background: rgba(0, 0, 0, 0.6);z-index: 9999999;color: #34495e;font-family: Trebuchet, Arial, sans-serif"><style>.moebtn,.moebtn>*{position:relative}.moebtn,.moebtn span,.moebtn:before{display:block}.moebtn{margin:30px auto;padding:0;overflow:hidden;border-width:0;outline:0;border-radius:2px;box-shadow:0 1px 4px rgba(0,0,0,.6);background-color:#2ecc71;color:#ecf0f1;transition:background-color .3s}.moebtn:focus,.moebtn:hover{background-color:#27ae60}.moe_content,.moebtn:before{position:absolute;top:50%;left:50%}.moebtn span{padding:12px 24px}.moebtn:before{content:"";width:0;padding-top:0;border-radius:100%;background-color:rgba(236,240,241,.3);-webkit-transform:translate(-50%,-50%);-moz-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.moebtn:active:before{width:120%;padding-top:120%;transition:width .5s ease-out,padding-top .5s ease-out}.moebtn.moeorange{background-color:#e67e22}.moebtn.moeorange:focus,.moebtn.moeorange:hover{background-color:#d35400}.moe_content{width:25%;transform:translate(-50%,-50%);background:rgba(255,255,255,.95);border-radius:10px 10px 0px 0px;text-align:center;display:inline-block}@media only screen and (max-width:800px){.moe_content{background:#fff;border-radius:10px 10px 0px 0px;display:inline-block;left:50%;position:absolute;text-align:center;top:50%;transform:translate(-EUNITNO50%,-50%);width:85%}}</style><div id="moe_container" style="text-align: center;display: table-cell;vertical-align: middle;"><div class="moe_content"><center><img src="https://cdn.moengage.com/images/check.gif" height="100px" width="100px"><h2 style="padding:5px;font-weight: 400;font-size:25px;">Thank you for subscribing!</h2><button type="button" class="moebtn moeorange"><span>Close</span></button></center><div style="text-align: right !important;position: absolute !important;    right: 0px !important;border-radius:0px 0px 10px 10px;width:100%;background:rgba(0,0,0,0.7);float:right;"><a href="#" target="_blank" style="text-decoration: none !important;cursor: pointer !important;color:#A5A0A0 !important;font-size: 11px !important;display:inline;" onclick="window.open(\'https://moengage.com/web-push/?utm_source=moengage_branding&utm_medium=webpush\',\'_blank\');event.cancelBubble = true; if (event.stopPropagation) event.stopPropagation();return false;"> Powered by <img src="https://cdn.moengage.com/images/logo-light.png" style="max-width: 100% !important; height: 35px !important;vertical-align: middle !important; padding-right: 3px !important;margin-bottom:auto;display:inline;"></a></div></div></div></div>';var e=c(d);document.body.insertBefore(e,document.body.childNodes[0])}function r(){try{"serviceWorker"in navigator?G=navigator.serviceWorker.register("/serviceworker.js",{scope:"/"}):console.log("Servie Worker Not Supported")}catch(a){x&&console.log("Serviceworker registration Failed!",a)}}function s(a){var b=Number(localStorage.getItem("SOFT_LOAD"))||Number(localStorage.getItem("MOE_LAST_PROMPT"))||0,c=Math.abs(Date.now()-b),d=Math.ceil(c/36e5);x&&console.log("Last prompt showed "+d+" hours ago.");var e=23;return"promptAgain"in a.webData&&(e=a.webData.promptAgain),d>e}var t,u,v={userName:"moewriteonly",password:"moe"},w="https://websdk.moengage.com",x=0,y=0,z="5.0",A={user_attr:{},event_queue:[],user_attr_queue:[],device_add:!1},B=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return x&&console.log("Generating new unique_id"),a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},C=function(){},D={track_event:C,add_user_attribute:C,add_first_name:C,add_last_name:C,add_email:C,add_mobile:C,add_user_name:C,add_gender:C,add_birthday:C,destroy_session:C,add_unique_user_id:C,moe_events:C,call_web_push:C,test_cases:C},E=navigator.userAgent;if(navigator.userAgent.indexOf("MSIE")!=-1||1==!!document.documentMode)return u="Internet Explorer",console.log("Browser not supported."),function(){return D};E.indexOf("Edge")>-1?u="Edge":E.indexOf("OPR")>-1||E.indexOf("Opera")>-1?u="Opera":E.indexOf("Chrome")>-1?(u="Google Chrome",E.indexOf("MMS")>-1&&(u="Opera Neon")):u=E.indexOf("Safari")>-1?"Apple Safari":E.indexOf("Firefox")>-1?"Mozilla Firefox":"Others";var F,G,H,I,J,K={Windows:function(){return/IEMobile/i.test(navigator.userAgent)},Android:function(){return/Android/i.test(navigator.userAgent)},BlackBerry:function(){return/BlackBerry/i.test(navigator.userAgent)},iOS:function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)}},L=0,M=0,N=0,O=5,P=!1,Q=!0,R=webio.factory(),S=webio.onload.p,T=webio.factory(),U=webio.factory(),V=webio.factory(),W=!1;S.then(function(){var a=new Event("moengage_loaded");window.dispatchEvent(a);try{if(window.moengage_q&&window.moengage_q.length>0&&window.moengage_object){for(key in window.moengage_q)window[window.moengage_object][window.moengage_q[key].f].apply(null,window.moengage_q[key].a);window.moengage_q=[]}}catch(a){x&&console.log(a)}});var X,Y="web";0==isMobileMoe?(Y="web",X=navigator.userAgent):1==isMobileMoe&&(Y="mweb",X=K.Windows()?"Windows":K.Android()?"Android":K.BlackBerry()?"BlackBerry":K.iOS()?"iOS":navigator.userAgent),X=navigator.userAgent;var Z,$=function(){N>O||(N+=1,(A.event_queue.length<L||A.user_attr_queue.length<M)&&(N=0),"event_queue"in A&&0!=A.event_queue.length&&da().then(function(a){post_data=A.event_queue.pop(),sa(w+"/v2/report/add",a,post_data,function(a,b){a=""==a?{}:JSON.parse(a),200==b?x&&console.log("Report Sent!"):(x&&console.log("Not sent queued!"),A.event_queue.push(post_data)),_(A)})}),"user_attr_queue"in A&&0!=A.user_attr_queue.length&&da().then(function(a){post_data=A.user_attr_queue.pop(),sa(w+"/v2/report/add",a,post_data,function(a,b){a=""==a?{}:JSON.parse(a),200==b?x&&console.log("Report Sent!"):(x&&console.log("Not sent queued!"),A.user_attr_queue.push(post_data)),_(A)})}),L=A.event_queue.length,M=A.user_attr_queue.length)},_=function(a,b){return new Promise(function(c,d){try{localStorage.setItem("moengage_data",JSON.stringify(a)),!b||httpsFlag||webSdkIntegration||n(a),c()}catch(a){x&&console.log("Cannot set Item",a),d()}})},aa=["USER_ATTRIBUTE_USER_EMAIL"],ba=function(a){return aa.indexOf(a)>-1},ca=function(){for(i in aa)if(aa[i]in A.user_attr&&""!=A.user_attr[aa[i]]&&"null"!=A.user_attr[aa[i]]&&"undefined"!=A.user_attr[aa[i]])return!0;return!1},da=function(){var a=new Date,b=Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds());return promise=new Promise(function(a){Ka().then(function(c){if(get_params={os:Y,os_platform:X,is_incognito:c,app_id:window.moe_data_internal.app_id,os_ver:u,sdk_ver:z,model:u,app_ver:1,device_ts:Number(b),device_tz_offset:(new Date).getTimezoneOffset()*-6e4,unique_id:A.uuid,device_tz:(new Date).getTimezoneOffset()},1==httpsFlag){var d=localStorage.getItem("MOE_PUSH_TOKEN");d&&"null"!=d?get_params.push_id=d:get_params.push_id="NA"}else if(1!=httpsFlag){var d=localStorage.getItem("MOE_PUSH_TOKEN");d&&"null"!=d?get_params.push_id=d:get_params.push_id="NA"}"NA"==get_params.push_id&&(get_params.push_id=""),"environment"in window.moe_data_internal&&""!=window.moe_data_internal.environment&&(get_params.environment=window.moe_data_internal.environment),a(get_params)})}),promise},ea=function(){return Z||(Z=new Promise(function(a){var b=24,c=(new Date).getTime(),d=localStorage.getItem("moeWebSDKSettingsSetupTime"),e=localStorage.getItem("ask_web_push");if(null==d||x)ra(w+"/websdksettings",{app_id:window.moe_data_internal.app_id},function(b){"string"==typeof b&&(b=JSON.parse(b));var d=JSON.stringify(b);localStorage.setItem("moeWebSDKSettingsSetupTime",c),localStorage.setItem("moeWebSDKSettings",d),a(b)});else if(c-d>60*b*60*1e3)ra(w+"/websdksettings",{app_id:window.moe_data_internal.app_id},function(b){"string"==typeof b&&(b=JSON.parse(b));var d=JSON.stringify(b);localStorage.removeItem("moeWebSDKSettings"),localStorage.removeItem("moeWebSDKSettingsSetupTime"),localStorage.setItem("moeWebSDKSettingsSetupTime",c),localStorage.setItem("moeWebSDKSettings",d),a(b)}),"false"==e&&localStorage.removeItem("ask_web_push");else{var f=JSON.parse(localStorage.getItem("moeWebSDKSettings"));a(f)}})),Z},fa=function(){return V.p.then(function(a){return ea().then(function(c){return"granted"!=a||"Google Chrome"!=u&&"Mozilla Firefox"!=u&&"Opera"!=u&&"Opera Neon"!=u||Q?Q&&"granted"==a&&1==c.webData.call_push_moengage&&"https"==c.webData.domain_type?T.p.then(function(){return b()}):b():T.p.then(function(){return b()})})})},ga=function(){t.backOffTime=1,t.subscribe("p/"+A.uuid),message=new Paho.MQTT.Message(JSON.stringify({unique_id:A.uuid})),message.destinationName="conn/"+window.moe_data_internal.app_id,t.send(message)},ha=function(a){try{var b=new Notification(a.title,{body:a.body,icon:a.icon,requireInteraction:a.requireInteraction});b.onclick=function(){window.open(a.url,"_blank"),b.close()}}catch(a){}},ia=function(a){ha(JSON.parse(a.payloadString))},ja=function(){connectionOptions={userName:v.userName,password:v.password},connectionOptions.onSuccess=ga,connectionOptions.onFailure=f,t=new Paho.MQTT.Client("52.207.253.219",1144,B()),t.onMessageArrived=ia,t.onConnectionLost=e,t.backOffTime=1,willMessageJson={unique_id:A.uuid},willMessage=new Paho.MQTT.Message(JSON.stringify(willMessageJson)),willMessage.destinationName="disc/"+window.moe_data_internal.app_id,connectionOptions.willMessage=willMessage,t.connect(connectionOptions)},ka=function(a){S.then(function(){ea().then(function(b){b.webData.ws&&1==b.webData.ws&&(message=new Paho.MQTT.Message(JSON.stringify(a)),message.destinationName="r/",message.destinationName+=window.moe_data_internal.app_id,message.qos=1,t&&t.isConnected()&&t.send(message))})}).catch(function(a){console.log("WS-CONNECT --",a)})},la=function(){wa("MOE_SUBSCRIPTION_TIMEOUT",{}),localStorage.setItem("MOE_HTTP_OVERLAY",5)};webio.onMessage("subscription_timeout",la),webio.onMessage("MOE_NEVER_ASK",function(){wa("MOE_SUBSCRIPTION_UNSUCCESSFUL",{}),localStorage.setItem("MOE_HTTP_OVERLAY",5)}),webio.onMessage("MOE_OPT_IN_SHOWN",function(){var a=new CustomEvent("MOE_OPT_IN",{detail:"opt_in_shown"});window.dispatchEvent(a),wa("MOE_OPT_IN_SHOWN",{})}),webio.onMessage("MOE_OPT_IN_DISMISSED",function(){var a=new CustomEvent("MOE_OPT_IN",{detail:"opt_in_dismissed"});window.dispatchEvent(a),wa("MOE_OPT_IN_DISMISSED",{})}),webio.onMessage("MOE_OPT_IN_ALLOWED",function(){var a=new CustomEvent("MOE_OPT_IN",{detail:"opt_in_allowed"});window.dispatchEvent(a),wa("MOE_OPT_IN_ALLOWED",{})}),webio.onMessage("MOE_OPT_IN_BLOCKED",function(){var a=new CustomEvent("MOE_OPT_IN",{detail:"opt_in_blocked"});window.dispatchEvent(a),wa("MOE_OPT_IN_BLOCKED",{})}),webio.onMessage("MOE_CONVENTIONAL_OPT_IN",function(){k()});var ma,na=function(){"complete"!=window.document.readyState?window.addEventListener("load",function(){webio.onload.res()}):webio.onload.res()},oa=function(a){Ka().then(function(a){window.moe_data_internal.is_incognito=a}),"retry_limit"in window.moe_data_internal&&(O=window.moe_data_internal.retry_limit),"debug_logs"in window.moe_data_internal&&(x=window.moe_data_internal.debug_logs),"cluster"in window.moe_data_internal&&"in"==window.moe_data_internal.cluster&&(w="https://apiv2mumbai.moengage.com/"),"environment"in window.moe_data_internal&&""!=window.moe_data_internal.environment&&(w="https://"+window.moe_data_internal.environment+".moengage.com"),"retry_time"in window.moe_data_internal?retry_time=window.moe_data_internal.retry_time:retry_time=2e3,debug_mode_message="%cYou are in %cdebug mode for Moengage, %cIf you are seeing this in production, please remove the debug flag!",x&&1!=a&&(window.moe_data_internal.app_id=window.moe_data_internal.app_id+"_DEBUG"),x&&console.log(debug_mode_message,"color: red; font-size:15px;","color: red; font-size:20px;","color: red; font-size:15px;"),x&&console.log("Browser detected: ",u),"undefined"!=typeof Storage?(G=void 0,Q=!1,R=webio.factory(),S=webio.onload.p,T=webio.factory(),U=webio.factory(),V=webio.factory(),W=!1,H=void 0,
I=void 0,J=void 0,ea().then(function(a){function b(){document.body?d.res():setTimeout(function(){b()},500)}if(U.p.then(function(b){"granted"!=b||localStorage.getItem("MOE_ACCEPTED")||xa("Web Migrated User","true"),"granted"==b?("ACCEPT"!=localStorage.getItem("MOE_ACCEPTED")&&(W=!0),localStorage.setItem("MOE_ACCEPTED","ACCEPT")):"denied"==b?(localStorage.getItem("MOE_PUSH_TOKEN")&&localStorage.setItem("MOE_PUSH_TOKEN","NA"),"DENY"!=localStorage.getItem("MOE_ACCEPTED")&&(W=!0),localStorage.setItem("MOE_ACCEPTED","DENY")):"prompt"==b&&(localStorage.removeItem("ask_web_push"),localStorage.getItem("MOE_PUSH_TOKEN")&&localStorage.setItem("MOE_PUSH_TOKEN","NA"),"PROMPT"!=localStorage.getItem("MOE_ACCEPTED")&&(W=!0),localStorage.setItem("MOE_ACCEPTED","PROMPT")),V.res(b),j(a),localStorage.getItem("MOE_PUSH_TOKEN")&&"NA"!=localStorage.getItem("MOE_PUSH_TOKEN")&&T.res()}),Q=!a.webData.PushSubBilling,R.p.then(function(){1==a.webData.call_push_moengage&&Oa()}),ma=a.webData.subdomainUrl||"https://abc.moengage.com/","https"==a.webData.domain_type){na(),httpsFlag=!0,r();var c=Notification.permission;c="default"==c?"prompt":c,H=c,U.res(c),pa()}else if(httpsFlag=!1,"http"!=a.webData.domain_type&&(webSdkIntegration=!0,x&&console.log("No webpush settings detected, you should be able to send events to moengage, but will not be able to send push! \nIf you need push capabilities, Please configure settings on Moengage dashboard on http://app.moengage.com/v3/#/settings/4 .")),webSdkIntegration)na(),pa(),U.res("");else{localStorage.getItem("MOE_PUSH_TOKEN")&&"NA"!=localStorage.getItem("MOE_PUSH_TOKEN")&&"null"!=localStorage.getItem("MOE_PUSH_TOKEN")&&localStorage.setItem("MOE_HTTP_OVERLAY",2);var d=webio.factory();b(),d.p.then(function(){var b=document.getElementById("moengage_iframe");if(b){var c=b.onload;b.onload=function(){c&&c instanceof Function&&c(),webio.onload.res()},setTimeout(function(){"complete"!=window.document.readyState?window.addEventListener("load",function(){webio.onload.res()}):webio.onload.res()},5e3)}else{var d=document.createElement("iframe");d.style.display="none",d.src=a.webData.subdomainUrl,d.id="moengage_iframe",d.onload=function(){webio.onload.res()},document.body.appendChild(d)}webio.sendMessageInit("moengage_iframe",ma),webio.sendMessage("is_already_accepted").then(function(a){"granted"==a.token&&(P=!0),H=a.token,U.res(a.token)}),m().then(function(a){var b=localStorage.getItem("MOE_PUSH_TOKEN");a.push&&"null"!=a.push&&b!=a.push&&localStorage.setItem("MOE_PUSH_TOKEN",a.push),localStorage.getItem("MOE_PUSH_TOKEN")&&"NA"!=localStorage.getItem("MOE_PUSH_TOKEN")&&"null"!=localStorage.getItem("MOE_PUSH_TOKEN")&&localStorage.setItem("MOE_HTTP_OVERLAY",2);var c=JSON.parse(a.token);null!=c&&"uuid"in c?(A=c,x&&console.log("User Linked from your iframe: ",c.uuid),_(A,!0).then(h)):pa()})})}})):x&&console.log("%cSorry, your browser does not support Web Storage...","color:red; font-size:20px")},pa=function(){var a=JSON.parse(localStorage.getItem("moengage_data"));null!=a&&"uuid"in a?(A=a,x&&console.log("Existing user detected, unique_id: ",a.uuid),_(A,!0).then(h)):(A.uuid=B(),x&&console.log("No existing user found, New unique_id generated and saved, unique_id: ",A),_(A,!0).then(h))},qa=function(){return window.moe_data_internal?window.moe_data_internal.app_id?(oa(),!0):(x&&console.log("%cApp Id is missing!","color:red; font-size:20px"),!1):(x&&console.log("Please pass data with moe like this moe({app_id:'t1'})"),!1)},ra=function(a,b,c){var d=new XMLHttpRequest;a=ta(a,b),d.open("GET",a,!0),d.onreadystatechange=function(){4==d.readyState&&200==d.status&&c&&c(d.responseText)},d.send()},sa=function(a,b,c,d){var e=new XMLHttpRequest;a=ta(a,b),e.open("POST",a,!0),e.onreadystatechange=function(){4==e.readyState&&d&&d(e.responseText,e.status,c)},e.send(JSON.stringify(c))},ta=function(a,b){a+="?";for(var c in b)a+=c+"="+b[c]+"&";return a},ua=function(a,arguments){var b="track_event_internal"==a?ya:za,c=arguments;return J||(J=webio.factory()),"add_user_attribute_internal"==a&&ba(arguments[0])&&""!=arguments[0]&&"null"!=arguments[0]&&"undefined"!=arguments[0]?b(c[0],c[1],c[2]).then(function(a){return a},function(a){return x&&console.log("Failed",a),"FAILED "+a}):J.p.then(function(){return b(c[0],c[1],c[2]).then(function(a){return a},function(a){return x&&console.log("Failed",a),"FAILED "+a})})},va=function(a){var b="https://www.google-analytics.com/collect",c="?";ea().then(function(d){if(d.webData.ga_tracking&&1==d.webData.ga_tracking){var e="v=1&t=event&tid=UA-51898729-2&cid="+A.uuid+"&ec="+window.moe_data_internal.app_id+"&ea="+a.e;c+=e,fetch(b+c,{method:"POST",body:JSON.stringify({})}).then(function(b){200==b.status?x&&console.log("GA Tracked",a.e):x&&console.log("GA Track Error",a.e)}).catch(function(a){x&&console.log("GA API CONNECT ERROR")})}})},wa=function(a,b,c){var arguments=[];return arguments.push(a),arguments.push(b),arguments.push(c),ua("track_event_internal",arguments)},xa=function(a,b,c){var arguments=[];return arguments.push(a),arguments.push(b),arguments.push(c),ua("add_user_attribute_internal",arguments)},ya=function(a,b,c){return R.p.then(function(){return new Promise(function(d,e){if(1==A.device_add){if(b="undefined"!=typeof b?b:{},"string"!=typeof a||"object"!=typeof b||""==typeof a)return x&&alert("Event attributes(key) needs to be string and (value) = json.\nThe type you gave for key is "+typeof a+" and for value is "+typeof b+'.\nHence event "'+String(a)+'" wont be added'),void e(a);da().then(function(e){date=new Date,b.URL=window.location.href,post_data={e:a,a:b};var f=new CustomEvent("MOE_EVENT",{detail:post_data});if(window.dispatchEvent(f),0==y)return"event_queue"in A||(A.event_queue=[]),x&&console.log("not sent queued!"),A.event_queue.push(post_data),_(A),void d(a);if("calldeviceadd"==c)var g="/v2/device/add";else var g="/v2/report/add";va(post_data),ka({get:e,post:post_data,ts:parseInt(get_params.device_ts/1e3)}),sa(w+g,e,post_data,function(b,c,e){b=""==b?{}:JSON.parse(b),200==c?x&&console.log("Event,",e,"  Tracked!"):("event_queue"in A||(A.event_queue=[]),x&&console.log("Not sent queued!"),A.event_queue.push(e),_(A)),d(a)})})}else x&&console.log("Event not tracked as device not added!"),e(a)})})},za=function(a,b,c){return R.p.then(function(){return new Promise(function(e,f){1==A.device_add||ba(a)&&""!=b&&"null"!=b&&"undefined"!=b?fa().then(function(){return"string"!=typeof a||""==typeof a||"object"==typeof b?void(x&&alert("User attributes(key) needs to be string and (value) = string/int/float/boolean.\nThe type you gave for key is "+typeof a+" and for value is "+typeof b+'.\nHence user attribute "'+String(a)+'" wont be added')):(c="undefined"!=typeof c?c:"",void da().then(function(f){return date=new Date,d={},d[a]=b,post_data={e:"EVENT_ACTION_USER_ATTRIBUTE",a:d,h:c},a in A.user_attr&&A.user_attr[a]==b?void e(a):(A.user_attr[a]=b,_(A,!0).then(function(){if(0==y)return"user_attr_queue"in A||(A.user_attr_queue=[]),x&&console.log("not sent queued!"),A.user_attr_queue.push(post_data),_(A),void e(a)}),ka({get:f,post:post_data,ts:parseInt(get_params.device_ts/1e3)}),sa(w+"/v2/report/add",f,post_data,function(b,c,d){b=""==b?{}:JSON.parse(b),200==c?x&&console.log("User Attribute, ",d,"  Tracked!"):("user_attr_queue"in A||(A.user_attr_queue=[]),x&&console.log("Not sent queued!"),A.user_attr_queue.push(d),_(A)),e(a)}),void 0)}))}):(x&&console.log("Event not tracked as device not added!.. Please note that, on a subscriber based billing, the user will be added %c ONLY on giving push permission or email."),f(a))})})},Aa=function(a,b){0!=httpsFlag||webSdkIntegration?Ba():webio.sendMessage("destroy_session").then(function(){Ba()})},Ba=function(){localStorage.removeItem("moeWebSDKSettings"),localStorage.removeItem("MOE_ACCEPTED"),localStorage.removeItem("moeWebSDKSettingsSetupTime"),localStorage.removeItem("moengage_data"),localStorage.removeItem("moe_push_storage"),localStorage.removeItem("moengage_data_subdomain"),localStorage.removeItem("moe-ftl"),localStorage.removeItem("MOE_PUSH_TOKEN"),localStorage.removeItem("ask_web_push"),localStorage.removeItem("MOE_LAST_PROMPT"),localStorage.removeItem("MOE_OPENED_ONCE"),localStorage.removeItem("SOFT_LOAD"),localStorage.removeItem("MOE_HTTP_OVERLAY"),A={user_attr:{},event_queue:[],user_attr_queue:[],device_add:!1},_(A),oa(!0)},Ca=function(a,b){return xa("USER_ATTRIBUTE_USER_FIRST_NAME",a,b)},Da=function(a,b){return xa("USER_ATTRIBUTE_USER_LAST_NAME",a,b)},Ea=function(a,b){return xa("USER_ATTRIBUTE_USER_EMAIL",a,b)},Fa=function(a,b){return xa("USER_ATTRIBUTE_USER_MOBILE",a,b)},Ga=function(a,b){return xa("USER_ATTRIBUTE_USER_NAME",a,b)},Ha=function(a,b){return xa("USER_ATTRIBUTE_USER_GENDER",a,b)},Ia=function(a,b){return xa("USER_ATTRIBUTE_USER_BDAY",a,b)},Ja=function(a,b){return xa("USER_ATTRIBUTE_UNIQUE_ID",a,b)},Ka=function(a){var b=window.RequestFileSystem||window.webkitRequestFileSystem,c=new Promise(function(a){b?b(window.TEMPORARY,100,function(){a(!1)},function(){a(!0)}):a(!1)});return c};Ka().then(function(a){F=a});var La,Ma=!0,Na=2;moeIsOpenedOnce=function(a){webio.sendMessage("opened_once").then(function(a){Ma="yes"==a.token,ea().then(function(a){q(a,P),s(a)&&V.p.then(function(a){if("prompt"==a){var b=new CustomEvent("MOE_OPT_IN",{detail:"opt_in_shown"});window.dispatchEvent(b),wa("MOE_OPT_IN_SHOWN",{})}l()})})}),"banner"==a&&(ea().then(function(a){a.webData.call_push_moengage&&wa("MOE_WEB_OPTIN_ACCEPTED",{})}),moeCloseBanner())},moeOpenPopup=function(){var a=ta(ma,La);window.open(a,"mywin","width=150,height=150,resizable=0"),document.getElementById("moe_overlay")?(document.getElementById("moe_overlay").style.opacity="0",document.getElementById("moe_overlay").style.display="none",wa("MOE_HTTP_OVERLAY_CLICKED",{REPEAT:P})):x&&console.log("MOENGAGE_OVERLAY MISSING")},moeSubscribeUserSwap=function(a){function b(){function a(){G.then(function(){navigator.serviceWorker.ready.then(function(a){return a.pushManager.subscribe({userVisibleOnly:!0})}).then(function(a){localStorage.setItem("ask_web_push",!1);var b=a.endpoint.split("/"),d=b[b.length-1];localStorage.setItem("MOE_PUSH_TOKEN",d),T.res(),localStorage.setItem("MOE_ACCEPTED","ACCEPT"),void 0==c||null==c?(fa().then(function(){xa("Web Push Preference","granted"),xa("Web Subscription URL",window.location.href),wa("MOE_USER_SUBSCRIBED",{MOE_WEB_PUSH_TOKEN:d,URL:window.location.href},"calldeviceadd"),wa("MOE_USER_SUBSCRIBED",{MOE_WEB_PUSH_TOKEN:d,URL:window.location.href})}),da().then(function(a){a.push_id=d,navigator.serviceWorker.controller.postMessage({data:a})})):(c!=d||W)&&(fa().then(function(){moeEvents.emitEvent("permission",["granted"]),xa("Web Push Preference","granted"),wa("MOE_USER_SUBSCRIPTION_CHECK",{MOE_WEB_PUSH_TOKEN:d,URL:window.location.href},"calldeviceadd"),wa("MOE_USER_SUBSCRIPTION_CHECK",{MOE_WEB_PUSH_TOKEN:d,URL:window.location.href})}),da().then(function(a){a.push_id=d,navigator.serviceWorker.controller.postMessage({data:a})}))}).catch(function(a){console.log(a)})})}da().then(function(a){navigator.serviceWorker.ready.then(function(){var b=localStorage.getItem("MOE_PUSH_TOKEN");b&&(a.push_id=b),navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({data:a})})}),V.p.then(function(a){"prompt"==a&&(ea().then(function(a){0==a.webData.banner.banner_flag&&moeLoadBannerInternal(!0)}),moeEvents.on("permission",function(a){hideOneClickTransparentOverlay()}))}),Notification.requestPermission(function(b){"granted"==b?(moeEvents.emitEvent("permission",["granted"]),V.p.then(function(a){if("prompt"==a){var b=new CustomEvent("MOE_OPT_IN",{detail:"opt_in_allowed"});window.dispatchEvent(b),wa("MOE_OPT_IN_ALLOWED",{})}}),a()):"default"==b?(V.p.then(function(a){if("prompt"==a){var b=new CustomEvent("MOE_OPT_IN",{detail:"opt_in_dismissed"});window.dispatchEvent(b),wa("MOE_OPT_IN_DISMISSED",{})}}),localStorage.setItem("MOE_PUSH_TOKEN","NA"),("PROMPT"!=d||W)&&(moeEvents.emitEvent("permission",["prompt"]),xa("Web Push Preference","prompt")),localStorage.setItem("MOE_LAST_PROMPT",Date.now()),moeEvents.emitEvent("permission",["clicked_close"]),localStorage.setItem("MOE_ACCEPTED","PROMPT"),ca()||Q||(A.device_add=!1,_(A,!0),I=null)):"denied"==b&&(V.p.then(function(a){if("prompt"==a){var b=new CustomEvent("MOE_OPT_IN",{detail:"opt_in_blocked"});window.dispatchEvent(b),wa("MOE_OPT_IN_BLOCKED",{}),wa("Web Push Opt-in Denied",{})}}),localStorage.setItem("MOE_PUSH_TOKEN","NA"),("DENY"!=d||W)&&(localStorage.setItem("ask_web_push",!1),moeEvents.emitEvent("permission",["denied"]),xa("Web Push Preference","denied")),localStorage.setItem("MOE_ACCEPTED","DENY"),ca()||Q||(A.device_add=!1,_(A,!0),I=null))})}var c=localStorage.getItem("MOE_PUSH_TOKEN"),d=localStorage.getItem("MOE_ACCEPTED");"banner"==a&&(ea().then(function(a){a.webData.call_push_moengage&&wa("MOE_WEB_OPTIN_ACCEPTED",{})}),moeCloseBanner()),V.p.then(function(a){"prompt"==a?ea().then(function(a){if(s(a)){var c=new CustomEvent("MOE_OPT_IN",{detail:"opt_in_shown"});window.dispatchEvent(c),wa("MOE_OPT_IN_SHOWN",{}),b()}}):b()})};var Oa=function(){V.p.then(function(){R.p.then(function(){"Google Chrome"!=u&&"Mozilla Firefox"!=u&&"Opera"!=u&&"Opera Neon"!=u||(x&&console.log("CALL WEB PUSH"),ea().then(function(a){Pa(a)}))})})},Pa=function(a){Ka().then(function(b){F=b;var c=localStorage.getItem("ask_web_push");if(F)x&&console.log("%cWEB Push - Not supported in Incognito-Mode","color: red; font-size:20px;");else if("https"==a.webData.domain_type){httpsFlag=!0;var d=0;a.webData.load_time&&1==a.webData.call_push_moengage&&(d=1e3*a.webData.load_time),a.webData.call_push_moengage&&a.webData.banner&&a.webData.banner.banner_flag?a.webData.call_push_moengage&&a.webData.banner&&a.webData.banner.banner_flag&&("granted"==H?setTimeout(moeSubscribeUserSwap,0):"false"!=c&&setTimeout(moeLoadBanner,d)):setTimeout(moeSubscribeUserSwap,d)}else"http"==a.webData.domain_type&&(httpsFlag=!1,da().then(function(b){La=b,delete La.os_platform,ma=a.webData.subdomainUrl||"https://abc.moengage.com/";var d=0;a.webData.load_time&&1==a.webData.call_push_moengage&&(d=1e3*a.webData.load_time),a.webData.call_push_moengage&&a.webData.banner&&a.webData.banner.banner_flag?a.webData.call_push_moengage&&a.webData.banner&&a.webData.banner.banner_flag&&("granted"==H?setTimeout(moeIsOpenedOnce,0):"false"!=c&&setTimeout(moeLoadBanner,d)):setTimeout(moeIsOpenedOnce,d)}))})},Qa=function(){return R.p.then(function(){return ea().then(function(a){return{userStructure:A,sdkSettings:a.webData}})})};return function(a){if(window.moe_data_internal=a,qa())return{track_event:wa,add_user_attribute:xa,add_first_name:Ca,add_last_name:Da,add_email:Ea,add_mobile:Fa,add_user_name:Ga,add_gender:Ha,add_birthday:Ia,destroy_session:Aa,add_unique_user_id:Ja,moe_events:moeEvents,call_web_push:Oa,test_cases:Qa}}}();